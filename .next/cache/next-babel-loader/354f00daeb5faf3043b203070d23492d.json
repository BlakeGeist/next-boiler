{"ast":null,"code":"import _objectSpread from \"@babel/runtime-corejs2/helpers/esm/objectSpread\";\n\nconst admin = require(\"firebase-admin\");\n\nexport default (async (req, res) => {\n  if (!admin.apps.length) admin.initializeApp({\n    credential: admin.credential.cert(require(\"../../credentials/server\"))\n  });\n  const req2 = await req;\n  if (!req2.body.token) return res.json({\n    status: 400\n  });\n  const {\n    token\n  } = req2.body;\n  admin.auth().verifyIdToken(token).then(async user => {\n    const db = admin.firestore();\n    const userDataCollection = db.collection('userData');\n    userDataCollection.doc(user.uid).get().then(doc => {\n      const userData = _objectSpread({}, user, doc.data());\n\n      return res.status(200).json({\n        user: userData\n      });\n    });\n  }).catch(error => {\n    res.json({\n      error: error\n    });\n  });\n});","map":{"version":3,"sources":["C:/Users/Blake Geist/Documents/blakes-apps/react/next-firebase-boiler/src/app/pages/api/getUserFromToken.js"],"names":["admin","require","req","res","apps","length","initializeApp","credential","cert","req2","body","token","json","status","auth","verifyIdToken","then","user","db","firestore","userDataCollection","collection","doc","uid","get","userData","data","catch","error"],"mappings":";;AAAA,MAAMA,KAAK,GAAGC,OAAO,CAAC,gBAAD,CAArB;;AAEA,gBAAe,OAAOC,GAAP,EAAYC,GAAZ,KAAoB;AAC/B,MAAG,CAACH,KAAK,CAACI,IAAN,CAAWC,MAAf,EACIL,KAAK,CAACM,aAAN,CAAoB;AAChBC,IAAAA,UAAU,EAAEP,KAAK,CAACO,UAAN,CAAiBC,IAAjB,CAAsBP,OAAO,CAAC,0BAAD,CAA7B;AADI,GAApB;AAGJ,QAAMQ,IAAI,GAAG,MAAMP,GAAnB;AACA,MAAI,CAACO,IAAI,CAACC,IAAL,CAAUC,KAAf,EAAsB,OAAOR,GAAG,CAACS,IAAJ,CAAS;AAAEC,IAAAA,MAAM,EAAE;AAAV,GAAT,CAAP;AACtB,QAAM;AAAEF,IAAAA;AAAF,MAAYF,IAAI,CAACC,IAAvB;AACAV,EAAAA,KAAK,CACAc,IADL,GAEKC,aAFL,CAEmBJ,KAFnB,EAGKK,IAHL,CAGU,MAAMC,IAAN,IAAc;AAChB,UAAMC,EAAE,GAAGlB,KAAK,CAACmB,SAAN,EAAX;AACA,UAAMC,kBAAkB,GAAGF,EAAE,CAACG,UAAH,CAAc,UAAd,CAA3B;AACAD,IAAAA,kBAAkB,CAACE,GAAnB,CAAuBL,IAAI,CAACM,GAA5B,EAAiCC,GAAjC,GACKR,IADL,CACUM,GAAG,IAAI;AACT,YAAMG,QAAQ,qBAAOR,IAAP,EAAgBK,GAAG,CAACI,IAAJ,EAAhB,CAAd;;AACA,aAAOvB,GAAG,CAACU,MAAJ,CAAW,GAAX,EAAgBD,IAAhB,CAAqB;AAAEK,QAAAA,IAAI,EAAEQ;AAAR,OAArB,CAAP;AACH,KAJL;AAKH,GAXL,EAYKE,KAZL,CAYWC,KAAK,IAAI;AACZzB,IAAAA,GAAG,CAACS,IAAJ,CAAS;AAAEgB,MAAAA,KAAK,EAAEA;AAAT,KAAT;AACH,GAdL;AAeH,CAvBD","sourcesContent":["const admin = require(\"firebase-admin\");\r\n\r\nexport default async (req, res) => {\r\n    if(!admin.apps.length)\r\n        admin.initializeApp({\r\n            credential: admin.credential.cert(require(\"../../credentials/server\"))\r\n        });\r\n    const req2 = await req;\r\n    if (!req2.body.token) return res.json({ status: 400 });\r\n    const { token } = req2.body;\r\n    admin\r\n        .auth()\r\n        .verifyIdToken(token)\r\n        .then(async user => {\r\n            const db = admin.firestore()\r\n            const userDataCollection = db.collection('userData')\r\n            userDataCollection.doc(user.uid).get()\r\n                .then(doc => {\r\n                    const userData = {...user, ...doc.data()}\r\n                    return res.status(200).json({ user: userData });\r\n                })\r\n        })\r\n        .catch(error => {\r\n            res.json({ error: error });\r\n        });\r\n};"]},"metadata":{},"sourceType":"module"}