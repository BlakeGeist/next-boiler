{"ast":null,"code":"const admin = require(\"firebase-admin\");\n\nexport default (async (req, res) => {\n  if (!admin.apps.length) {\n    admin.initializeApp({\n      credential: admin.credential.cert(require(\"../../credentials/server\"))\n    });\n  }\n\n  ;\n  const req2 = await req;\n  if (!req2.body.email) return res.json({\n    status: 400\n  });\n  const {\n    email,\n    uid\n  } = req2.body;\n  const db = admin.firestore();\n\n  if (uid) {\n    const stringsCollection = db.collection(\"userData\");\n    await stringsCollection.doc(uid).update({\n      newsLetterEmail: email,\n      isSubscribedToNewsletter: true\n    }).then(() => {}).catch(e => {\n      res.json({\n        error: e\n      });\n    });\n  }\n\n  const stringsCollection = db.collection(\"newsLetterEmails\");\n  await stringsCollection.doc(email).set({\n    email\n  }).then(() => {\n    return res.status(200).json({\n      message: `You added ${email} to the newsletter list`\n    });\n  }).catch(e => {\n    res.json({\n      error: e\n    });\n  });\n});","map":null,"metadata":{},"sourceType":"module"}